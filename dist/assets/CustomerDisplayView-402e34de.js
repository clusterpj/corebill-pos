import{J as K,K as Q,e as F,L as W,M as R,I as A,_ as S,n as o,N as X,o as P,O as Y,P as Z,d as k,t as ee,A as te,v as b,h as se,Q as z,g as ae,q as v,c as re,V as oe,u as le,R as ie,H as ne,S as ce}from"./index-cee48f53.js";import{l as V,L as l,M as d,N as e,F as t,bh as C,bl as j,u,a8 as N,bk as s,bi as n,be as g,bm as w,r as $,j as ue,H as L,bp as de,a6 as me,a9 as fe}from"./vuetify-3f7b308f.js";const pe={class:"promo-content"},_e={class:"text-h3 font-weight-bold mb-4"},ye={class:"text-h5 mb-6"},he=V({__name:"PromoSlider",setup(D){const r=K().promos;return(f,p)=>(l(),d(F,{class:"promo-slider h-100",elevation:"0",rounded:"0"},{default:e(()=>[t(Q,{cycle:"",height:"100%","hide-delimiter-background":"","show-arrows":"hover",interval:"6000",class:"fill-height","hide-delimiters":""},{default:e(()=>[(l(!0),C(N,null,j(u(r),(i,_)=>(l(),d(W,{key:_,src:i.image,cover:""},{default:e(()=>[t(R,{class:"promo-overlay d-flex align-center justify-center flex-column text-center",height:"100%",width:"100%"},{default:e(()=>[s("div",pe,[s("h2",_e,n(i.title),1),s("div",ye,n(i.description),1),i.discount?(l(),d(A,{key:0,color:"error",size:"x-large",class:"text-h5 px-8 py-4"},{default:e(()=>[g(n(i.discount),1)]),_:2},1024)):w("",!0)])]),_:2},1024)]),_:2},1032,["src"]))),128))]),_:1})]),_:1}))}});const ve=S(he,[["__scopeId","data-v-b469c95e"]]),ge={key:0,class:"text-caption text-primary"},xe={class:"flex-grow-1 overflow-y-auto"},be={class:"text-center"},Ce={class:"cart-summary pa-4"},we={class:"d-flex justify-space-between"},Se={class:"d-flex justify-space-between"},Ve={class:"text-error"},De={class:"d-flex justify-space-between"},Ie={class:"d-flex justify-space-between text-h5 font-weight-bold"},Te=V({__name:"CustomerDisplay",setup(D){o.info("CustomerDisplay component initializing...");const m=X(),r=P(),f=$(!1);let p=null;const i=ue(()=>{const c=r.stores.find(a=>a.id===r.selectedStore);return o.debug("Current store computed:",c),c}),{items:_,discountType:q,discountValue:I,taxRate:B,subtotal:E,taxAmount:U,discountAmount:M,total:T}=Y(m),y=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format((c||0)/100);let x=null;const O=async()=>{f.value||(f.value=!0,await new Promise(c=>setTimeout(c,50)),m.initializeFromStorage(),await new Promise(c=>setTimeout(c,20)),f.value=!1)},G=()=>{p||(p=window.setInterval(()=>{O()},1e3),o.info("Auto-refresh started"))},H=()=>{p&&(window.clearInterval(p),p=null),o.info("Auto-refresh stopped")};return L(async()=>{var c;o.info("CustomerDisplay mounted, initializing cart sync..."),m.initializeFromStorage(),x=Z.subscribeToUpdates(a=>{o.info("Received cart update:",a),m.$patch(a)}),G();try{document.documentElement.requestFullscreen&&(await document.documentElement.requestFullscreen(),o.info("✅ Entered fullscreen mode successfully"))}catch(a){o.warn("⚠️ Failed to enter fullscreen mode:",a)}o.info("CustomerDisplay initialized:",{store:i.value,cartItems:((c=_.value)==null?void 0:c.length)||0,cartTotal:T.value||0})}),de(()=>{x&&x(),H()}),(c,a)=>(l(),d(oe,{fluid:"",class:"fill-height pa-0"},{default:e(()=>[t(re,{class:"fill-height ma-0"},{default:e(()=>[t(k,{cols:"12",md:"7",class:"pa-4"},{default:e(()=>[t(ee,null,{default:e(()=>[me(t(F,{class:"cart-display h-100 d-flex flex-column",elevation:"2"},{default:e(()=>[t(te,{class:"text-center text-h5 py-4 flex-shrink-0"},{default:e(()=>[a[0]||(a[0]=g(" Current Order ")),i.value?(l(),C("div",ge,n(i.value.name)+" (Store #"+n(i.value.id)+") ",1)):w("",!0)]),_:1}),t(b),t(se,{class:"flex-grow-1 d-flex flex-column pa-0"},{default:e(()=>[s("div",xe,[u(_)&&u(_).length>0?(l(),d(z,{key:0,class:"order-items"},{default:e(()=>[(l(!0),C(N,null,j(u(_),(h,J)=>(l(),d(v,{key:J,title:h.name,subtitle:`${y(h.price)} each`,class:"py-2"},{prepend:e(()=>[t(A,{size:"small",color:"grey-lighten-3",class:"mr-2"},{default:e(()=>[g(n(h.quantity),1)]),_:2},1024)]),append:e(()=>[g(n(y(h.price*h.quantity)),1)]),_:2},1032,["title","subtitle"]))),128))]),_:1})):(l(),d(R,{key:1,class:"d-flex align-center justify-center fill-height"},{default:e(()=>[s("div",be,[t(ae,{size:"64",color:"grey-lighten-2",class:"mb-4"},{default:e(()=>a[1]||(a[1]=[g("mdi-cart-outline")])),_:1}),a[2]||(a[2]=s("div",{class:"text-subtitle-1 text-grey"},"No items in cart",-1))])]),_:1}))]),t(b),s("div",Ce,[t(z,{density:"compact",class:"totals"},{default:e(()=>[t(v,{density:"compact"},{title:e(()=>[s("div",we,[a[3]||(a[3]=s("span",null,"Subtotal",-1)),s("span",null,n(y(u(E))),1)])]),_:1}),u(I)>0?(l(),d(v,{key:0,density:"compact"},{title:e(()=>[s("div",Se,[s("span",null,"Discount "+n(u(q)==="%"?`(${u(I)}%)`:""),1),s("span",Ve,"-"+n(y(u(M))),1)])]),_:1})):w("",!0),t(v,{density:"compact"},{title:e(()=>[s("div",De,[s("span",null,"Tax ("+n((u(B)*100).toFixed(1))+"%)",1),s("span",null,n(y(u(U))),1)])]),_:1}),t(b,{class:"my-2"}),t(v,{density:"compact"},{title:e(()=>[s("div",Ie,[a[4]||(a[4]=s("span",null,"Total",-1)),s("span",null,n(y(u(T))),1)])]),_:1})]),_:1})])]),_:1})]),_:1},512),[[fe,!f.value]])]),_:1})]),_:1}),t(k,{cols:"12",md:"5",class:"pa-0 d-flex"},{default:e(()=>[t(ve,{class:"fill-height w-100"})]),_:1})]),_:1})]),_:1}))}});const ke=S(Te,[["__scopeId","data-v-10729b49"]]),ze=V({__name:"CustomerDisplayView",setup(D){const m=le(),r=P(),f=$(!1);async function p(){try{if(o.startGroup("Customer Display: Initializing"),await r.initializeStore(),!r.isConfigured||!r.selectedStore){o.warn("Store not properly configured, redirecting to cashier selection",{isConfigured:r.isConfigured,selectedStore:r.selectedStore,selectedCustomer:r.selectedCustomer,selectedCashier:r.selectedCashier}),m.push("/select-cashier");return}r.stores.length===0&&(o.info("Fetching stores data..."),await r.fetchStores()),f.value=!0,o.info("Customer display initialized successfully",{store:r.currentStore,storeId:r.selectedStore})}catch(i){o.error("Failed to initialize customer display:",i),m.push("/select-cashier")}finally{o.endGroup()}}return L(async()=>{await p()}),(i,_)=>(l(),d(ce,{class:"customer-display-layout"},{default:e(()=>[f.value?(l(),d(ke,{key:0})):(l(),d(ie,{key:1,"model-value":!0,class:"align-center justify-center"},{default:e(()=>[t(ne,{size:"64",color:"primary",indeterminate:""})]),_:1}))]),_:1}))}});const Ae=S(ze,[["__scopeId","data-v-9b23abe8"]]);export{Ae as default};
//# sourceMappingURL=CustomerDisplayView-402e34de.js.map
