{"version":3,"file":"CustomerDisplayView-b6450f62.js","sources":["../../src/views/pos/components/PromoSlider.vue","../../src/views/pos/components/CustomerDisplay.vue","../../src/views/pos/CustomerDisplayView.vue"],"sourcesContent":["<template>\n  <v-card class=\"promo-slider h-100\" elevation=\"0\" rounded=\"0\">\n    <v-carousel\n      cycle\n      height=\"100%\"\n      hide-delimiter-background\n      show-arrows=\"hover\"\n      interval=\"6000\"\n      class=\"fill-height\"\n      hide-delimiters\n    >\n      <v-carousel-item\n        v-for=\"(promo, i) in promos\"\n        :key=\"i\"\n        :src=\"promo.image\"\n        cover\n      >\n        <v-sheet\n          class=\"promo-overlay d-flex align-center justify-center flex-column text-center\"\n          height=\"100%\"\n          width=\"100%\"\n        >\n          <div class=\"promo-content\">\n            <h2 class=\"text-h3 font-weight-bold mb-4\">{{ promo.title }}</h2>\n            <div class=\"text-h5 mb-6\">{{ promo.description }}</div>\n            <v-chip\n              v-if=\"promo.discount\"\n              color=\"error\"\n              size=\"x-large\"\n              class=\"text-h5 px-8 py-4\"\n            >\n              {{ promo.discount }}\n            </v-chip>\n          </div>\n        </v-sheet>\n      </v-carousel-item>\n    </v-carousel>\n  </v-card>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue'\n\n// Sample promos data - replace with actual data from your backend\nconst promos = ref([\n  {\n    title: 'Fresh Produce Special',\n    description: 'All organic fruits and vegetables',\n    discount: '15% OFF',\n    image: 'https://images.unsplash.com/photo-1542838132-92c53300491e?auto=format&fit=crop&q=80'\n  },\n  {\n    title: 'Weekly Meal Deal',\n    description: 'Buy any main dish and get a free beverage',\n    discount: 'FREE DRINK',\n    image: 'https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&q=80'\n  },\n  {\n    title: 'Family Pack Savings',\n    description: 'Perfect for family gatherings',\n    discount: 'Save 20%',\n    image: 'https://images.unsplash.com/photo-1498837167922-ddd27525d352?auto=format&fit=crop&q=80'\n  },\n  {\n    title: 'Daily Fresh Bread',\n    description: 'Freshly baked every morning',\n    discount: '2 for $5',\n    image: 'https://images.unsplash.com/photo-1509440159596-0249088772ff?auto=format&fit=crop&q=80'\n  },\n  {\n    title: 'Happy Hour Special',\n    description: 'All smoothies and fresh juices',\n    discount: '25% OFF',\n    image: 'https://images.unsplash.com/photo-1505252585461-04db1eb84625?auto=format&fit=crop&q=80'\n  }\n])\n</script>\n\n<style scoped>\n.promo-slider {\n  background: transparent;\n  width: 100%;\n  overflow: hidden;\n}\n\n.v-carousel {\n  height: 100vh !important;\n}\n\n.promo-overlay {\n  background: rgba(0, 0, 0, 0.5);\n  color: white;\n}\n\n.promo-content {\n  padding: 2rem;\n  background: rgba(0, 0, 0, 0.4);\n  border-radius: 16px;\n  backdrop-filter: blur(8px);\n  max-width: 80%;\n}\n\n.v-carousel__controls {\n  background: linear-gradient(to top, rgba(0,0,0,0.5), transparent);\n}\n\n.text-h3 {\n  text-shadow: 2px 2px 4px rgba(0,0,0,0.5);\n}\n\n.text-h5 {\n  text-shadow: 1px 1px 2px rgba(0,0,0,0.5);\n}\n\n.v-chip {\n  font-weight: 700 !important;\n  box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n}\n</style>\n","<template>\n  <v-container fluid class=\"fill-height pa-0\">\n    <v-row class=\"fill-height ma-0\">\n      <!-- Cart Section -->\n      <v-col cols=\"7\" class=\"pa-4\">\n        <v-fade-transition>\n          <v-card class=\"cart-display h-100 d-flex flex-column\" elevation=\"2\" v-show=\"!isRefreshing\">\n            <v-card-title class=\"text-center text-h5 py-4 flex-shrink-0\">\n              Current Order\n              <div v-if=\"currentStore\" class=\"text-caption text-primary\">\n                {{ currentStore.name }} (Store #{{ currentStore.id }})\n              </div>\n            </v-card-title>\n\n            <v-divider></v-divider>\n\n            <v-card-text class=\"flex-grow-1 d-flex flex-column pa-0\">\n              <div class=\"flex-grow-1 overflow-y-auto\">\n                <v-list v-if=\"cartItems && cartItems.length > 0\" class=\"order-items\">\n                  <v-list-item\n                    v-for=\"(item, index) in cartItems\"\n                    :key=\"index\"\n                    :title=\"item.name\"\n                    :subtitle=\"`${formatPrice(item.price)} each`\"\n                    class=\"py-2\"\n                  >\n                    <template v-slot:prepend>\n                      <v-chip size=\"small\" color=\"grey-lighten-3\" class=\"mr-2\">\n                        {{ item.quantity }}\n                      </v-chip>\n                    </template>\n                    <template v-slot:append>\n                      {{ formatPrice(item.price * item.quantity) }}\n                    </template>\n                  </v-list-item>\n                </v-list>\n\n                <v-sheet v-else class=\"d-flex align-center justify-center fill-height\">\n                  <div class=\"text-center\">\n                    <v-icon size=\"64\" color=\"grey-lighten-2\" class=\"mb-4\">mdi-cart-outline</v-icon>\n                    <div class=\"text-subtitle-1 text-grey\">No items in cart</div>\n                  </div>\n                </v-sheet>\n              </div>\n\n              <v-divider></v-divider>\n\n              <div class=\"cart-summary pa-4\">\n                <v-list density=\"compact\" class=\"totals\">\n                  <v-list-item density=\"compact\">\n                    <template v-slot:title>\n                      <div class=\"d-flex justify-space-between\">\n                        <span>Subtotal</span>\n                        <span>{{ formatPrice(cartSubtotal) }}</span>\n                      </div>\n                    </template>\n                  </v-list-item>\n\n                  <v-list-item v-if=\"cartDiscountValue > 0\" density=\"compact\">\n                    <template v-slot:title>\n                      <div class=\"d-flex justify-space-between\">\n                        <span>Discount {{ cartDiscountType === '%' ? `(${cartDiscountValue}%)` : '' }}</span>\n                        <span class=\"text-error\">-{{ formatPrice(cartDiscountAmount) }}</span>\n                      </div>\n                    </template>\n                  </v-list-item>\n\n                  <v-list-item density=\"compact\">\n                    <template v-slot:title>\n                      <div class=\"d-flex justify-space-between\">\n                        <span>Tax ({{ (cartTaxRate * 100).toFixed(1) }}%)</span>\n                        <span>{{ formatPrice(cartTaxAmount) }}</span>\n                      </div>\n                    </template>\n                  </v-list-item>\n\n                  <v-divider class=\"my-2\"></v-divider>\n\n                  <v-list-item density=\"compact\">\n                    <template v-slot:title>\n                      <div class=\"d-flex justify-space-between text-h5 font-weight-bold\">\n                        <span>Total</span>\n                        <span>{{ formatPrice(cartTotal) }}</span>\n                      </div>\n                    </template>\n                  </v-list-item>\n                </v-list>\n              </div>\n            </v-card-text>\n          </v-card>\n        </v-fade-transition>\n      </v-col>\n\n      <!-- Promo Section -->\n      <v-col cols=\"5\" class=\"pa-0 d-flex\">\n        <PromoSlider class=\"fill-height w-100\" />\n      </v-col>\n    </v-row>\n  </v-container>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, onUnmounted, ref } from 'vue'\nimport { useCartStore } from '@/stores/cart-store'\nimport { useCompanyStore } from '@/stores/company'\nimport { storeToRefs } from 'pinia'\nimport { logger } from '@/utils/logger'\nimport { cartSync } from '@/services/cartSync'\nimport PromoSlider from './PromoSlider.vue'\n\nlogger.info('CustomerDisplay component initializing...')\n\nconst cartStore = useCartStore()\nconst companyStore = useCompanyStore()\nconst isRefreshing = ref(false)\nlet refreshInterval: number | null = null\nlet updateTimeout: number | null = null\n\n// Get current store from company store\nconst currentStore = computed(() => {\n  const store = companyStore.stores.find(s => s.id === companyStore.selectedStore)\n  logger.debug('Current store computed:', store)\n  return store\n})\n\n// Use storeToRefs for reactive cart properties\nconst { \n  items: cartItems,\n  discountType: cartDiscountType,\n  discountValue: cartDiscountValue,\n  taxRate: cartTaxRate,\n  subtotal: cartSubtotal,\n  taxAmount: cartTaxAmount,\n  discountAmount: cartDiscountAmount,\n  total: cartTotal\n} = storeToRefs(cartStore)\n\n// Format price helper\nconst formatPrice = (cents: number): string => {\n  const formatted = new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 2\n  }).format((cents || 0) / 100)\n  return formatted\n}\n\n// Handle cart updates\nlet unsubscribeFromCartSync: (() => void) | null = null\n\n// Refresh data with transition\nconst refreshData = async () => {\n  if (isRefreshing.value) return\n\n  isRefreshing.value = true\n  \n  // Shorter fade out\n  await new Promise(resolve => setTimeout(resolve, 50))\n  \n  // Update data\n  cartStore.initializeFromStorage()\n  \n  // Almost immediate show of new content\n  await new Promise(resolve => setTimeout(resolve, 20))\n  \n  isRefreshing.value = false\n}\n\n// Start periodic refresh\nconst startAutoRefresh = () => {\n  if (refreshInterval) return\n  \n  // Refresh every second\n  refreshInterval = window.setInterval(() => {\n    refreshData()\n  }, 1000)\n  \n  logger.info('Auto-refresh started')\n}\n\n// Stop periodic refresh\nconst stopAutoRefresh = () => {\n  if (refreshInterval) {\n    window.clearInterval(refreshInterval)\n    refreshInterval = null\n  }\n  \n  if (updateTimeout) {\n    window.clearTimeout(updateTimeout)\n    updateTimeout = null\n  }\n  \n  logger.info('Auto-refresh stopped')\n}\n\nonMounted(() => {\n  logger.info('CustomerDisplay mounted, initializing cart sync...')\n  \n  // Initialize from storage first\n  cartStore.initializeFromStorage()\n  \n  // Subscribe to cart updates\n  unsubscribeFromCartSync = cartSync.subscribeToUpdates((newState) => {\n    logger.info('Received cart update:', newState)\n    cartStore.$patch(newState)\n  })\n\n  // Start auto-refresh\n  startAutoRefresh()\n\n  logger.info('CustomerDisplay initialized:', {\n    store: currentStore.value,\n    cartItems: cartItems.value?.length || 0,\n    cartTotal: cartTotal.value || 0\n  })\n})\n\nonUnmounted(() => {\n  // Clean up subscription\n  if (unsubscribeFromCartSync) {\n    unsubscribeFromCartSync()\n  }\n  \n  // Stop auto-refresh\n  stopAutoRefresh()\n})\n</script>\n\n<style scoped>\n.cart-display {\n  will-change: opacity;\n  backface-visibility: hidden;\n  transform: translateZ(0);\n}\n\n.order-items {\n  will-change: opacity;\n}\n\n.cart-summary {\n  background: #f5f5f5;\n}\n\n.totals {\n  background: transparent !important;\n}\n\n.v-fade-transition {\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.v-fade-transition-enter-active,\n.v-fade-transition-leave-active {\n  transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n}\n\n.v-fade-transition-enter-from,\n.v-fade-transition-leave-to {\n  opacity: 0.98;\n}\n\n.v-fade-transition-enter-to,\n.v-fade-transition-leave-from {\n  opacity: 1;\n}\n\n/* Add hardware acceleration */\n* {\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n/* Custom scrollbar */\n::-webkit-scrollbar {\n  width: 8px;\n}\n\n::-webkit-scrollbar-track {\n  background: #f1f1f1;\n  border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb {\n  background: #888;\n  border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: #555;\n}\n</style>\n","<template>\r\n  <v-layout class=\"customer-display-layout\">\r\n    <template v-if=\"isInitialized\">\r\n      <customer-display />\r\n    </template>\r\n    <template v-else>\r\n      <v-overlay\r\n        :model-value=\"true\"\r\n        class=\"align-center justify-center\"\r\n      >\r\n        <v-progress-circular\r\n          size=\"64\"\r\n          color=\"primary\"\r\n          indeterminate\r\n        />\r\n      </v-overlay>\r\n    </template>\r\n  </v-layout>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { useCompanyStore } from '@/stores/company'\r\nimport CustomerDisplay from './components/CustomerDisplay.vue'\r\nimport { logger } from '@/utils/logger'\r\n\r\nconst router = useRouter()\r\nconst companyStore = useCompanyStore()\r\nconst isInitialized = ref(false)\r\n\r\nasync function initializeDisplay() {\r\n  try {\r\n    logger.startGroup('Customer Display: Initializing')\r\n    \r\n    // Try to initialize from stored data first\r\n    await companyStore.initializeStore()\r\n    \r\n    // Check if store is properly configured\r\n    if (!companyStore.isConfigured || !companyStore.selectedStore) {\r\n      logger.warn('Store not properly configured, redirecting to cashier selection', {\r\n        isConfigured: companyStore.isConfigured,\r\n        selectedStore: companyStore.selectedStore,\r\n        selectedCustomer: companyStore.selectedCustomer,\r\n        selectedCashier: companyStore.selectedCashier\r\n      })\r\n      router.push('/select-cashier')\r\n      return\r\n    }\r\n\r\n    // Double check store data is loaded\r\n    if (companyStore.stores.length === 0) {\r\n      logger.info('Fetching stores data...')\r\n      await companyStore.fetchStores()\r\n    }\r\n\r\n    isInitialized.value = true\r\n    logger.info('Customer display initialized successfully', {\r\n      store: companyStore.currentStore,\r\n      storeId: companyStore.selectedStore\r\n    })\r\n  } catch (error) {\r\n    logger.error('Failed to initialize customer display:', error)\r\n    router.push('/select-cashier')\r\n  } finally {\r\n    logger.endGroup()\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  await initializeDisplay()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.customer-display-layout {\r\n  background-color: #f5f5f5;\r\n  min-height: 100vh;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n</style>\r\n"],"names":["promos","ref","logger","cartStore","useCartStore","companyStore","useCompanyStore","isRefreshing","refreshInterval","currentStore","computed","store","s","cartItems","cartDiscountType","cartDiscountValue","cartTaxRate","cartSubtotal","cartTaxAmount","cartDiscountAmount","cartTotal","storeToRefs","formatPrice","cents","unsubscribeFromCartSync","refreshData","resolve","startAutoRefresh","stopAutoRefresh","onMounted","cartSync","newState","_a","onUnmounted","router","useRouter","isInitialized","initializeDisplay","error"],"mappings":"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"}