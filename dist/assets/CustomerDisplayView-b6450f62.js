import{I as J,e as R,J as W,K as j,H as A,_ as w,n,o as P,L as X,d as z,t as Q,z as Y,v as b,h as Z,M as T,g as ee,q as g,c as te,V as se,u as ae,N as oe,G as ie,O as re}from"./index-9f2fee20.js";import{l as V,r as D,L as i,M as d,N as e,F as t,bg as C,bk as N,X as $,bj as s,bh as l,be as v,bl as S,j as le,H as q,bo as ne,ak as ce,ao as ue,u}from"./vuetify-7130618d.js";import{u as de,c as pe}from"./cart-store-98b500d5.js";const fe={class:"promo-content"},me={class:"text-h3 font-weight-bold mb-4"},_e={class:"text-h5 mb-6"},he=V({__name:"PromoSlider",setup(F){const p=D([{title:"Fresh Produce Special",description:"All organic fruits and vegetables",discount:"15% OFF",image:"https://images.unsplash.com/photo-1542838132-92c53300491e?auto=format&fit=crop&q=80"},{title:"Weekly Meal Deal",description:"Buy any main dish and get a free beverage",discount:"FREE DRINK",image:"https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&q=80"},{title:"Family Pack Savings",description:"Perfect for family gatherings",discount:"Save 20%",image:"https://images.unsplash.com/photo-1498837167922-ddd27525d352?auto=format&fit=crop&q=80"},{title:"Daily Fresh Bread",description:"Freshly baked every morning",discount:"2 for $5",image:"https://images.unsplash.com/photo-1509440159596-0249088772ff?auto=format&fit=crop&q=80"},{title:"Happy Hour Special",description:"All smoothies and fresh juices",discount:"25% OFF",image:"https://images.unsplash.com/photo-1505252585461-04db1eb84625?auto=format&fit=crop&q=80"}]);return(o,m)=>(i(),d(R,{class:"promo-slider h-100",elevation:"0",rounded:"0"},{default:e(()=>[t(J,{cycle:"",height:"100%","hide-delimiter-background":"","show-arrows":"hover",interval:"6000",class:"fill-height","hide-delimiters":""},{default:e(()=>[(i(!0),C($,null,N(p.value,(r,f)=>(i(),d(W,{key:f,src:r.image,cover:""},{default:e(()=>[t(j,{class:"promo-overlay d-flex align-center justify-center flex-column text-center",height:"100%",width:"100%"},{default:e(()=>[s("div",fe,[s("h2",me,l(r.title),1),s("div",_e,l(r.description),1),r.discount?(i(),d(A,{key:0,color:"error",size:"x-large",class:"text-h5 px-8 py-4"},{default:e(()=>[v(l(r.discount),1)]),_:2},1024)):S("",!0)])]),_:2},1024)]),_:2},1032,["src"]))),128))]),_:1})]),_:1}))}});const ye=w(he,[["__scopeId","data-v-22296095"]]),ge={key:0,class:"text-caption text-primary"},ve={class:"flex-grow-1 overflow-y-auto"},xe={class:"text-center"},be={class:"cart-summary pa-4"},Ce={class:"d-flex justify-space-between"},Se={class:"d-flex justify-space-between"},we={class:"text-error"},Ve={class:"d-flex justify-space-between"},De={class:"d-flex justify-space-between text-h5 font-weight-bold"},Fe=V({__name:"CustomerDisplay",setup(F){n.info("CustomerDisplay component initializing...");const p=de(),o=P(),m=D(!1);let r=null;const f=le(()=>{const c=o.stores.find(a=>a.id===o.selectedStore);return n.debug("Current store computed:",c),c}),{items:h,discountType:B,discountValue:k,taxRate:L,subtotal:O,taxAmount:H,discountAmount:M,total:I}=X(p),_=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format((c||0)/100);let x=null;const U=async()=>{m.value||(m.value=!0,await new Promise(c=>setTimeout(c,50)),p.initializeFromStorage(),await new Promise(c=>setTimeout(c,20)),m.value=!1)},E=()=>{r||(r=window.setInterval(()=>{U()},1e3),n.info("Auto-refresh started"))},G=()=>{r&&(window.clearInterval(r),r=null),n.info("Auto-refresh stopped")};return q(()=>{var c;n.info("CustomerDisplay mounted, initializing cart sync..."),p.initializeFromStorage(),x=pe.subscribeToUpdates(a=>{n.info("Received cart update:",a),p.$patch(a)}),E(),n.info("CustomerDisplay initialized:",{store:f.value,cartItems:((c=h.value)==null?void 0:c.length)||0,cartTotal:I.value||0})}),ne(()=>{x&&x(),G()}),(c,a)=>(i(),d(se,{fluid:"",class:"fill-height pa-0"},{default:e(()=>[t(te,{class:"fill-height ma-0"},{default:e(()=>[t(z,{cols:"7",class:"pa-4"},{default:e(()=>[t(Q,null,{default:e(()=>[ce(t(R,{class:"cart-display h-100 d-flex flex-column",elevation:"2"},{default:e(()=>[t(Y,{class:"text-center text-h5 py-4 flex-shrink-0"},{default:e(()=>[a[0]||(a[0]=v(" Current Order ")),f.value?(i(),C("div",ge,l(f.value.name)+" (Store #"+l(f.value.id)+") ",1)):S("",!0)]),_:1}),t(b),t(Z,{class:"flex-grow-1 d-flex flex-column pa-0"},{default:e(()=>[s("div",ve,[u(h)&&u(h).length>0?(i(),d(T,{key:0,class:"order-items"},{default:e(()=>[(i(!0),C($,null,N(u(h),(y,K)=>(i(),d(g,{key:K,title:y.name,subtitle:`${_(y.price)} each`,class:"py-2"},{prepend:e(()=>[t(A,{size:"small",color:"grey-lighten-3",class:"mr-2"},{default:e(()=>[v(l(y.quantity),1)]),_:2},1024)]),append:e(()=>[v(l(_(y.price*y.quantity)),1)]),_:2},1032,["title","subtitle"]))),128))]),_:1})):(i(),d(j,{key:1,class:"d-flex align-center justify-center fill-height"},{default:e(()=>[s("div",xe,[t(ee,{size:"64",color:"grey-lighten-2",class:"mb-4"},{default:e(()=>a[1]||(a[1]=[v("mdi-cart-outline")])),_:1}),a[2]||(a[2]=s("div",{class:"text-subtitle-1 text-grey"},"No items in cart",-1))])]),_:1}))]),t(b),s("div",be,[t(T,{density:"compact",class:"totals"},{default:e(()=>[t(g,{density:"compact"},{title:e(()=>[s("div",Ce,[a[3]||(a[3]=s("span",null,"Subtotal",-1)),s("span",null,l(_(u(O))),1)])]),_:1}),u(k)>0?(i(),d(g,{key:0,density:"compact"},{title:e(()=>[s("div",Se,[s("span",null,"Discount "+l(u(B)==="%"?`(${u(k)}%)`:""),1),s("span",we,"-"+l(_(u(M))),1)])]),_:1})):S("",!0),t(g,{density:"compact"},{title:e(()=>[s("div",Ve,[s("span",null,"Tax ("+l((u(L)*100).toFixed(1))+"%)",1),s("span",null,l(_(u(H))),1)])]),_:1}),t(b,{class:"my-2"}),t(g,{density:"compact"},{title:e(()=>[s("div",De,[a[4]||(a[4]=s("span",null,"Total",-1)),s("span",null,l(_(u(I))),1)])]),_:1})]),_:1})])]),_:1})]),_:1},512),[[ue,!m.value]])]),_:1})]),_:1}),t(z,{cols:"5",class:"pa-0 d-flex"},{default:e(()=>[t(ye,{class:"fill-height w-100"})]),_:1})]),_:1})]),_:1}))}});const ke=w(Fe,[["__scopeId","data-v-b31c59fc"]]),Ie=V({__name:"CustomerDisplayView",setup(F){const p=ae(),o=P(),m=D(!1);async function r(){try{if(n.startGroup("Customer Display: Initializing"),await o.initializeStore(),!o.isConfigured||!o.selectedStore){n.warn("Store not properly configured, redirecting to cashier selection",{isConfigured:o.isConfigured,selectedStore:o.selectedStore,selectedCustomer:o.selectedCustomer,selectedCashier:o.selectedCashier}),p.push("/select-cashier");return}o.stores.length===0&&(n.info("Fetching stores data..."),await o.fetchStores()),m.value=!0,n.info("Customer display initialized successfully",{store:o.currentStore,storeId:o.selectedStore})}catch(f){n.error("Failed to initialize customer display:",f),p.push("/select-cashier")}finally{n.endGroup()}}return q(async()=>{await r()}),(f,h)=>(i(),d(re,{class:"customer-display-layout"},{default:e(()=>[m.value?(i(),d(ke,{key:0})):(i(),d(oe,{key:1,"model-value":!0,class:"align-center justify-center"},{default:e(()=>[t(ie,{size:"64",color:"primary",indeterminate:""})]),_:1}))]),_:1}))}});const je=w(Ie,[["__scopeId","data-v-9b23abe8"]]);export{je as default};
//# sourceMappingURL=CustomerDisplayView-b6450f62.js.map
